## 软件中断指令 int
- int 0x13: x86 架构下的 BIOS 磁盘服务中断, 用于在实模式下执行底层磁盘操作(如读取、写入、格式化等)。它是早期操作系统和引导加载程序直接访问硬件的关键接口。
- int 0x10: 是 x86 实模式下的 BIOS 视频服务中断, 用于控制文本/图形显示、光标、颜色等。它是早期操作系统和引导程序直接操作屏幕的核心接口。

## cli 与 sti
- cli: 禁用可屏蔽中断(将 CPU 的 IF 标志位清零), CPU 不再响应外部硬件中断(如键盘、定时器、磁盘等), 但不可屏蔽中断(NMI)和异常(如除零)仍会被处理。
- sti: 将 CPU 状态寄存器中的IF（Interrupt Flag，中断标志位）设置为 1。在执行 sti 后，CPU 恢复对可屏蔽中断的响应能力，与 cli 形成互补操作。
## hlt
暂停 CPU 执行, 直到下一个中断发生。CPU 进入低功耗状态, 停止取指和执行, 但保持寄存器和内存状态。
- 唤醒条件: 
    - 任何不可屏蔽中断(NMI)或已启用的可屏蔽中断(需 IF=1)。
    - 复位信号(如硬件重启)。

## nasm 中的伪指令
- equ: 用于定义符号常量。`SDA_PHY_ADDR equ 0x00007e00` 类似 C 语言中的 `#define SDA_PHY_ADDR 0x00007e00`
- times: 用于 重复填充 指定次数的字节、字或双字, times 重复次数 填充内容


## nasm 中的 $ 与 $$
- `$`: 当前地址
- `$$`: 当前段起始地址, 如 `SECTION  mbr vstart=0x00007c00` 是设置当前段起始地址为 0x00007c00

## `xor edx, edx` 与 `or edx, edx`
- `xor edx, edx`: 将 edx 寄存器 清零, 同时设置标志位(ZF=1, SF=0, CF=0, OF=0)
- `or edx, edx`: 对 edx 自身做 按位或运算(edx | edx), 不改变寄存器值, 仅设置标志位

## 0x0d, 0x0a
回车符和换行符的 ASCII 编码

## cpuid
cpuid 是 x86 架构的 CPU 识别指令, 用于查询处理器支持的功能、型号、扩展特性等信息。

## lgdt
将 GDT 的基地址加载到 GDTR(GDT 基地址寄存器)中, 从而让 CPU 可以通过 GDTR 访问 GDT

## in 与 out
- in destination, source: source -> destination
    - destination 是目标寄存器, 用于存储从端口读取的数据。可以是AL、AX或EAX, 分别用于读取8位、16位或32位数据。
    - source 是端口号, 可以是直接的数值(如0x92)或存储在 dx 寄存器中的值。
- out destination, source: source -> destination
    - destination 是端口号, 可以是直接的数值(如0x92)或存储在DX寄存器中的值。
    - source 是要写入端口的数据, 可以是AL、AX或EAX, 分别用于写入8位、16位或32位数据。
- 端口号: 硬件设备的端口号通常在设备的技术手册或数据手册中明确列出。

## 显存
显存是计算机显卡中用于存储屏幕显示数据的内存区域。它直接与显卡的硬件(如显示控制器)相连, 用于存储屏幕上显示的图像数据或文本数据。直接内存映射而不用 in/out 端口. 

- 在文本模式下: 屏幕显示的是字符而不是像素。屏幕通常被划分为一个字符网格, 例如常见的 80 列 × 25 行 的布局。这种布局意味着屏幕上可以显示 2000 个字符。每个字符占用 2 个字节, 第一个字节存储字符的 ASCII 码。第二个字节存储字符的显示属性(如颜色、闪烁等)。对于彩色文本模式, 显存的起始地址是 0xb800:0000。对于单色文本模式, 显存的起始地址是 0xb000:0000。
- 在图形模式下: 显存直接存储屏幕上每个像素的颜色信息，而非字符，因此能显示更丰富的图像、图形和色彩，是现代操作系统和图形界面（如 Windows、Linux 桌面环境）的基础工作模式。屏幕被划分为大量像素点（如 1024×768、1920×1080 等分辨率），每个像素的颜色由显存中特定位置的字节（或多个字节）定义。例如：
    - 256 色模式：每个像素用 1 字节表示（对应 256 种预定义颜色）。
    - 真彩色模式（RGB）：每个像素用 3 字节表示（红、绿、蓝各 1 字节，共 2⁴种颜色）。

## iretq
是 x86-64 架构汇编语言中的一条指令，它是 iret 指令的 64 位版本。这条指令用于从中断处理程序中返回
- 弹出指令指针（RIP）
- 弹出代码段寄存器（CS）
- 弹出标志寄存器（RFLAGS）

## LBA 扇区号
- LBA（Logical Block Addressing，逻辑块地址）是一种硬盘寻址方式，用于定位硬盘上的数据存储位置。它将硬盘的存储空间划分为一个个固定大小的块，每个块称为一个 扇区（Sector）。每个扇区的大小通常是 512 字节, 这是传统磁盘大小, 几乎所有的旧式磁盘和许多现代硬盘仍然使用这个大小。较新的磁盘扇区大小是 4096 字节, 也就是 4kb.
- LBA 扇区号是从硬盘的起始位置开始，按顺序编号的整数。硬盘的第一个扇区（主引导扇区，MBR）的 LBA 扇区号为 0，第二个扇区的 LBA 扇区号为 1，依此类推。
- LBA 扇区号是一个 64 位的整数，可以表示非常大的存储空间。

## 硬盘格式: .vhd、.vmdk、.img...
- **.vhd** 文件格式由微软开发，主要用于 Hyper-V 平台，支持固定大小、动态扩展和差异磁盘，具有良好的集成支持和启动能力。
    - **文件头（Header）**：包含虚拟硬盘的版本信息、时间戳、创建者信息等。
    - **页表（Page Table）**：用于管理虚拟硬盘的存储块（通常是固定大小的块）。
    - **数据块（Data Blocks）**：实际存储虚拟硬盘的数据。
    - **尾部（Footer）**：包含虚拟硬盘的大小、类型等信息。
- **.vmdk** 文件格式由 VMware 开发，用于其虚拟化产品，具有复杂的文件结构，支持高性能操作和高级功能，如快照和克隆。
- **.img** 文件格式是一种通用的磁盘镜像格式，结构简单，适用于多种平台和设备，适合简单的备份和恢复操作。

